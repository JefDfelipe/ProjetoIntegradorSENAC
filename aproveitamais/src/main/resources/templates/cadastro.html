<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Aproveita+ Cadastro</title>
  <link rel="stylesheet" href="../static/style/cadastro.css">
</head>

<body>

  <div class="logo">
    <img
      src="https://raw.githubusercontent.com/JefDfelipe/ProjetoIntegradorSENAC/efa40fef3c04fb54c2a8720fd3f292f723eee886/logo.png"
      alt="Logo do site">
  </div>

  <div class="container">
    <form class="registration-form">
      <h1>Cadastro de Cliente</h1>
      <div class="box">
        <h3>Dados Pessoais</h3>
        <div class="form-group">
          <label for="tipo">Tipo de Cadastro:</label>
          <select id="tipo" name="tipo" required>
            <option value="pessoa-fisica">Pessoa Física</option>
            <option value="pessoa-juridica">Pessoa Jurídica</option>
          </select>
        </div>

        <div class="form-group" id="cpf-field">
          <label for="cpf">CPF:</label>
          <input type="text" id="cpf" name="cpf" required>
        </div>

        <div class="form-group" id="cnpj-field">
          <label for="cnpj">CNPJ:</label>
          <input type="text" id="cnpj" name="cnpj">
        </div>

        <div class="form-group">
          <label for="nome">Nome:</label>
          <input type="text" id="nome" name="nome" required>
        </div>
        <div class="form-group">
          <label for="email">E-mail:</label>
          <input type="email" id="email" name="email" required>
        </div>
        <div class="form-group">
          <label for="senha">Senha:</label>
          <input type="password" id="senha" name="senha" required>
        </div>
        <div class="form-group">
          <label for="confirmar-senha">Confirmar Senha:</label>
          <input type="password" id="confirmar-senha" name="confirmar-senha" required>
        </div>

        <!-- Mais campos para pessoa jurídica -->
        <div class="form-group" id="razao-social-field">
          <label for="razao-social">Razão Social:</label>
          <input type="text" id="razao-social" name="razao-social">
        </div>

        <div class="form-group" id="nome-fantasia-field">
          <label for="nome-fantasia">Nome Fantasia:</label>
          <input type="text" id="nome-fantasia" name="nome-fantasia">
        </div>

        <div class="form-group" id="inscricao-estadual-field">
          <label for="inscricao-estadual">Inscrição Estadual:</label>
          <input type="text" id="inscricao-estadual" name="inscricao-estadual">
        </div>

        <div class="form-group" id="isencao-estadual-field">
          <label for="isencao-estadual">Isento de Inscrição Estadual:</label>
          <input type="checkbox" id="isencao-estadual" name="isencao-estadual">
        </div>
      </div>


      <div class="box">
        <!-- Campos de informações de entrega -->
        <h3>Informações de Entrega</h3>

        <div class="form-group">
          <label for="cep">CEP:</label>
          <input type="text" id="cep" name="cep">
          <button type="button" id="cep-consulta">Consultar CEP</button>
        </div>
        <div class="form-group">
          <label for="endereco">Endereço:</label>
          <input type="text" id="endereco" name="endereco">
        </div>

        <div class="form-group">
          <label for="cidade">Cidade:</label>
          <input type="text" id="cidade" name="cidade">
        </div>

        <div class="form-group">
          <label for="estado">Estado:</label>
          <input type="text" id="estado" name="estado">
        </div>


        <!-- Opção para concordar em receber comunicações de e-mail marketing -->
        <div class="form-group">
          <input type="checkbox" id="email-marketing" name="email-marketing">
          <label for="email-marketing">Concordo em receber comunicações</label>
        </div>

        <!-- Confirmação da veracidade dos dados e aceite de termos de uso -->
        <div class="form-group">
          <input type="checkbox" id="veracidade-dados" name="veracidade-dados" required>
          <label for="veracidade-dados">Confirmo a veracidade dos dados:</label>
        </div>

        <div class="form-group">
          <input type="checkbox" id="termos-uso" name="termos-uso" required>
          <label for="termos-uso">Aceito os Termos de Uso:</label>
        </div>

        <button type="submit" class="submit-button">Cadastrar</button>
    </form>
  </div>

  <script>
    // Função para mostrar campos de CPF e ocultar campos de CNPJ
    function showCPF() {
      document.getElementById("cpf-field").style.display = "block";
      document.getElementById("cnpj-field").style.display = "none";
      document.getElementById("razao-social-field").style.display = "none";
      document.getElementById("nome-fantasia-field").style.display = "none";
      document.getElementById("inscricao-estadual-field").style.display = "none";
      document.getElementById("isencao-estadual-field").style.display = "none";
    }

    // Função para mostrar campos de CNPJ e ocultar campos de CPF
    function showCNPJ() {
      document.getElementById("cpf-field").style.display = "none";
      document.getElementById("cnpj-field").style.display = "block";
      document.getElementById("razao-social-field").style.display = "block";
      document.getElementById("nome-fantasia-field").style.display = "block";
      document.getElementById("inscricao-estadual-field").style.display = "block";
      document.getElementById("isencao-estadual-field").style.display = "block";
    }

    // Detectar mudanças na seleção
    document.getElementById("tipo").addEventListener("change", function () {
      var tipoSelecionado = this.value;

      if (tipoSelecionado === "pessoa-fisica") {
        showCPF();
      } else if (tipoSelecionado === "pessoa-juridica") {
        showCNPJ();
      }
    });

    // Inicialmente, mostrar campos de CPF por padrão
    showCPF();

    //Verificação de veracidade de CPF
    function validarCPF(cpf) {
      cpf = cpf.replace(/[^\d]+/g, ''); // Remove caracteres não numéricos

      if (cpf === '' || cpf.length !== 11 || /^(\d)\1+$/.test(cpf)) {
        return false; // CPF inválido
      }

      let sum = 0;
      let remainder;

      for (let i = 1; i <= 9; i++) {
        sum += parseInt(cpf.substring(i - 1, i)) * (11 - i);
      }

      remainder = (sum * 10) % 11;

      if (remainder === 10 || remainder === 11) {
        remainder = 0;
      }

      if (remainder !== parseInt(cpf.substring(9, 10))) {
        return false; // CPF inválido
      }

      sum = 0;

      for (let i = 1; i <= 10; i++) {
        sum += parseInt(cpf.substring(i - 1, i)) * (12 - i);
      }

      remainder = (sum * 10) % 11;

      if (remainder === 10 || remainder === 11) {
        remainder = 0;
      }

      if (remainder !== parseInt(cpf.substring(10, 11))) {
        return false; // CPF inválido
      }

      return true; // CPF válido
    }

    // Função para verificar o CEP usando a API ViaCEP
    function verificarCEP(cep) {
      fetch(`https://viacep.com.br/ws/${cep}/json/`)
        .then((response) => response.json())
        .then((data) => {
          if (!data.erro) {
            // CEP válido, preencha os campos de endereço
            document.getElementById("endereco").value = data.logradouro;
            document.getElementById("cidade").value = data.localidade;
            document.getElementById("estado").value = data.uf;
          } else {
            // CEP inválido, exiba uma mensagem de erro
            alert("CEP não encontrado. Verifique o CEP informado.");
          }
        })
        .catch((error) => {
          console.error("Erro ao consultar CEP:", error);
        });
    }

    // Adicionar evento de clique ao botão "Consultar CEP"
    document.getElementById("cep-consulta").addEventListener("click", function () {
      const cep = document.getElementById("cep").value.replace(/\D/g, ''); // Remove caracteres não numéricos
      if (cep.length === 8) {
        verificarCEP(cep);
      } else {
        alert("O CEP deve conter 8 dígitos.");
      }
    });
  </script>
</body>

</html>